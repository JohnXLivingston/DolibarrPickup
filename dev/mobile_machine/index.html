<!doctype html><html lang=fr class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.94.2"><meta name=description content="Documentation du module Dolibarr DolibarrPickup"><meta name=author content="John Livingston"><link rel=icon href=/DolibarrPickup/images/favicon.png type=image/png><title>API de l'application Mobile :: Documentation DolibarrPickup</title><link href=/DolibarrPickup/css/nucleus.css?1647595654 rel=stylesheet><link href=/DolibarrPickup/css/fontawesome-all.min.css?1647595654 rel=stylesheet><link href=/DolibarrPickup/css/hybrid.css?1647595654 rel=stylesheet><link href=/DolibarrPickup/css/featherlight.min.css?1647595654 rel=stylesheet><link href=/DolibarrPickup/css/perfect-scrollbar.min.css?1647595654 rel=stylesheet><link href=/DolibarrPickup/css/auto-complete.css?1647595654 rel=stylesheet><link href=/DolibarrPickup/css/atom-one-dark-reasonable.css?1647595654 rel=stylesheet><link href=/DolibarrPickup/css/theme.css?1647595654 rel=stylesheet><link href=/DolibarrPickup/css/hugo-theme.css?1647595654 rel=stylesheet><link href=/DolibarrPickup/css/theme-blue.css?1647595654 rel=stylesheet><script src=/DolibarrPickup/js/jquery-3.3.1.min.js?1647595654></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/DolibarrPickup/dev/mobile_machine/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=https://johnxlivingston.github.io/DolibarrPickup><svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="32" height="32" viewBox="0 0 8.4666665 8.4666669" id="svg8" inkscape:version="1.0.2 (e86c870879, 2021-01-15)" sodipodi:docname="pickup.svg" inkscape:export-xdpi="96" inkscape:export-ydpi="96"><defs id="defs2"/><sodipodi:namedview id="base" pagecolor="#0000ff" bordercolor="#666666" borderopacity="1" inkscape:pageopacity="0" inkscape:pageshadow="2" inkscape:zoom="11.313708" inkscape:cx="15.039202" inkscape:cy="22.757451" inkscape:document-units="px" inkscape:current-layer="layer1" inkscape:document-rotation="0" showgrid="false" units="px" inkscape:pagecheckerboard="false" inkscape:window-width="1854" inkscape:window-height="1016" inkscape:window-x="1680" inkscape:window-y="27" inkscape:window-maximized="1"/><g inkscape:label="Calque 1" inkscape:groupmode="layer" id="layer1"><path style="fill:#fff;fill-opacity:1;stroke:#fff;stroke-width:.264583px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="M.76843052 6.0470054.73781622 1.7241142 5.9705895 1.661581 6.510308 4.1191467l1.1720274.032642.044323 1.9026014-.8697785-925e-6s-.519302-.5168007-.8487333-.5065306C5.6787153 5.5572045 5.117323 6.0516151 5.117323 6.0516151l-.8697785-925e-6-.8697784-925e-6s-.4496626-.5526329-.8870497-.5376445c-.4093396.014027-.8525073.5358021-.8525073.5358021z" id="path1422" sodipodi:nodetypes="ccccccczcccscc"/><ellipse style="fill:#fff;fill-opacity:1;stroke:#fff;stroke-width:.264999;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="path1426" cx="2.5137596" cy="6.3425317" rx=".42074397" ry=".40052378"/><ellipse style="fill:#fff;fill-opacity:1;stroke:#fff;stroke-width:.264999;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="path1426-3" cx="6.0189147" cy="6.4056315" rx=".42074397" ry=".40052378"/></g></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Rechercher...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/DolibarrPickup/js/lunr.min.js?1647595654></script>
<script type=text/javascript src=/DolibarrPickup/js/auto-complete.js?1647595654></script>
<script type=text/javascript>var baseurl="https://johnxlivingston.github.io/DolibarrPickup"</script><script type=text/javascript src=/DolibarrPickup/js/search.js?1647595654></script></div><div class=highlightable><ul class=topics><li data-nav-id=/DolibarrPickup/presentation/ title="Présentation du module" class=dd-item><a href=/DolibarrPickup/presentation/>Présentation du module
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/DolibarrPickup/presentation/pickups/ title="Les collectes" class=dd-item><a href=/DolibarrPickup/presentation/pickups/>Les collectes
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/DolibarrPickup/presentation/pickups/1-pickup/ title="La fiche collecte" class=dd-item><a href=/DolibarrPickup/presentation/pickups/1-pickup/>La fiche collecte
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/DolibarrPickup/presentation/pickups/4-workflow/ title=Statuts class=dd-item><a href=/DolibarrPickup/presentation/pickups/4-workflow/>Statuts
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/DolibarrPickup/presentation/pickups/8-deee/ title=DEEE class=dd-item><a href=/DolibarrPickup/presentation/pickups/8-deee/>DEEE
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/DolibarrPickup/presentation/pickups/9-others/ title=Divers class=dd-item><a href=/DolibarrPickup/presentation/pickups/9-others/>Divers
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/DolibarrPickup/presentation/mobileapp/ title="L'application mobile" class=dd-item><a href=/DolibarrPickup/presentation/mobileapp/>L'application mobile
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/DolibarrPickup/presentation/mobileapp/intro/ title="En deux mots" class=dd-item><a href=/DolibarrPickup/presentation/mobileapp/intro/>En deux mots
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/DolibarrPickup/presentation/mobileapp/screenshots/ title="Captures d'écran" class=dd-item><a href=/DolibarrPickup/presentation/mobileapp/screenshots/>Captures d'écran
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/DolibarrPickup/presentation/reports/ title="Les rapports" class=dd-item><a href=/DolibarrPickup/presentation/reports/>Les rapports
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/DolibarrPickup/user/ title="Documentation utilisateur⋅rice" class=dd-item><a href=/DolibarrPickup/user/>Documentation utilisateur⋅rice
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/DolibarrPickup/user/mobileapp/ title="Application mobile" class=dd-item><a href=/DolibarrPickup/user/mobileapp/>Application mobile
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/DolibarrPickup/user/mobileapp/intro/ title=Introduction class=dd-item><a href=/DolibarrPickup/user/mobileapp/intro/>Introduction
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/DolibarrPickup/user/mobileapp/navigation/ title=Navigation class=dd-item><a href=/DolibarrPickup/user/mobileapp/navigation/>Navigation
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/DolibarrPickup/user/mobileapp/pagetypes/ title="Type d'écrans" class=dd-item><a href=/DolibarrPickup/user/mobileapp/pagetypes/>Type d'écrans
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/DolibarrPickup/user/mobileapp/pagetypes/pick/ title="Écrans de sélection" class=dd-item><a href=/DolibarrPickup/user/mobileapp/pagetypes/pick/>Écrans de sélection
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/DolibarrPickup/user/mobileapp/pagetypes/show/ title=Fiches class=dd-item><a href=/DolibarrPickup/user/mobileapp/pagetypes/show/>Fiches
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/DolibarrPickup/user/mobileapp/pagetypes/form/ title=Formulaires class=dd-item><a href=/DolibarrPickup/user/mobileapp/pagetypes/form/>Formulaires
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/DolibarrPickup/user/mobileapp/pagetypes/save/ title=Sauvegarde class=dd-item><a href=/DolibarrPickup/user/mobileapp/pagetypes/save/>Sauvegarde
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/DolibarrPickup/user/mobileapp/workflow/ title="Flux de travail" class=dd-item><a href=/DolibarrPickup/user/mobileapp/workflow/>Flux de travail
<i class="fas fa-check read-icon"></i></a></li></ul></li></ul></li><li data-nav-id=/DolibarrPickup/admin/ title=Administration/Configuration class=dd-item><a href=/DolibarrPickup/admin/>Administration/Configuration
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/DolibarrPickup/admin/install/ title=Installation class=dd-item><a href=/DolibarrPickup/admin/install/>Installation
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/DolibarrPickup/admin/setup/ title=Configurer class=dd-item><a href=/DolibarrPickup/admin/setup/>Configurer
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/DolibarrPickup/admin/setup/features/ title=Fonctionnalités class=dd-item><a href=/DolibarrPickup/admin/setup/features/>Fonctionnalités
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/DolibarrPickup/admin/setup/rights/ title="Les droits" class=dd-item><a href=/DolibarrPickup/admin/setup/rights/>Les droits
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/DolibarrPickup/admin/update/ title="Mise à jour" class=dd-item><a href=/DolibarrPickup/admin/update/>Mise à jour
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/DolibarrPickup/dev/ title=Contribuer class="dd-item
parent"><a href=/DolibarrPickup/dev/>Contribuer
<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/DolibarrPickup/dev/mobile_machine/ title="API de l'application Mobile" class="dd-item active"><a href=/DolibarrPickup/dev/mobile_machine/>API de l'application Mobile
<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/DolibarrPickup/problems/ title="Problèmes connus" class=dd-item><a href=/DolibarrPickup/problems/>Problèmes connus
<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/DolibarrPickup/support/ title=Support class=dd-item><a href=/DolibarrPickup/support/>Support
<i class="fas fa-check read-icon"></i></a></li></ul><section id=shortcuts><h3>Aller plus loin</h3><ul><li><a class=padding href=https://github.com/JohnXLivingston/DolibarrPickup><i class="fab fa-github"></i> Dépot Github</a></li><li><a class=padding href=https://code.globenet.org/john/DolibarrPickup><i class="fab fa-git"></i> Dépot Globenet</a></li></ul></section><section id=prefooter><hr><ul><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Supprimer l'historique</a></li></ul></section><section id=footer><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a> from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=/DolibarrPickup/>DolibarrPickup</a> > <a href=/DolibarrPickup/dev/>Contribuer</a> > API de l'application Mobile</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#définition-de-lautomate>Définition de l&rsquo;automate</a></li><li><a href=#états>États</a><ul><li><a href=#state>State</a></li><li><a href=#statechoice>StateChoice</a></li><li><a href=#stateform>StateForm</a></li><li><a href=#statepick>StatePick</a></li><li><a href=#stateselect>StateSelect</a></li><li><a href=#stateshow>StateShow</a></li><li><a href=#statevirtual>StateVirtual</a></li><li><a href=#statecompute>StateCompute</a></li><li><a href=#statesave>StateSave</a></li></ul></li><li><a href=#notes>Notes</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>API de l'application Mobile</h1><h1 id=application-mobile--automate>Application mobile : Automate</h1><p>L&rsquo;application mobile utilise un automate à état fini pour son fonctionnement.</p><p>L&rsquo;automate est décrit dans le fichier <a href=/src/mobile.ts>mobile.ts</a>.</p><p>À l&rsquo;exécution, on aura une pile (stack) qui retiendra tous les choix successifs, et toutes les valeurs des différents formulaires rencontrés.</p><h2 id=définition-de-lautomate>Définition de l&rsquo;automate</h2><p>La définition de l&rsquo;automate est un object javascript.</p><p>Chaque clé de cet objet représente un écran.</p><p>L&rsquo;écran initial doit avoir pour clé «init».</p><p>Chaque état est ensuite décrit par un object javascript. La clé <code>type</code> donne le type d&rsquo;écran.</p><h2 id=états>États</h2><p>Le présent chapitre liste les différents états et leurs différentes options.</p><h3 id=state>State</h3><p>La classe <a href=/src/lib/state/state.ts>State</a> est la classe de base.
Les options qu&rsquo;auront tous les autres états :</p><h4 id=type>type</h4><p>Le type de l&rsquo;état. Le fichier <a href=/src/lib/state/index.ts>index.ts</a> va se baser sur cette valeur pour instancier la bonne classe.</p><h4 id=label>label</h4><p>Le nom de l&rsquo;écran. Sera affiché en haut.</p><h3 id=statechoice>StateChoice</h3><p>La classe <a href=/src/lib/state/choice.ts>StateChoice</a> représente un écran qui proposera plusieurs choix, sous forme de boutons.</p><h4 id=choices>choices</h4><p>L&rsquo;option <code>choices</code> est un tableau d&rsquo;objets de la forme :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>label</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Le libellé du choix&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>value</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;La valeur associée&#39;</span>, <span style=color:#75715e>// c&#39;est la valeur qui sera mise dans la stack
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>goto</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;stateX&#39;</span>, <span style=color:#75715e>// vers quel state aller quand on fait ce choix
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;xxx&#39;</span> <span style=color:#75715e>// Optionnel. voir plus loin
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><p>Le champ <code>name</code> est optionnel. Il permet de changer le nom du champ qui sera stocké dans la stack (par défaut c&rsquo;est le nom de l&rsquo;état courant).</p><h3 id=stateform>StateForm</h3><p>La classe <a href=/src/lib/state/form.ts>StateForm</a> représente un formulaire.</p><h4 id=goto>goto</h4><p>Vers quel état aller quand le formulaire est validé.</p><h4 id=fields>fields</h4><p>Un tableau de définition de champs.</p><p>Ce code étant encore amené à beaucoup bouger, la documentation de ce qu&rsquo;est un <code>field</code> est volontairement incomplète. On ne retrouve ici que les attributs de base, communs à tous les types de champs.</p><h5 id=type-1>type</h5><p>Le type du champ (<code>varchar</code>, <code>text</code>, <code>integer</code>, <code>select</code>, &mldr;).</p><h5 id=name>name</h5><p>Le nom technique du champs. Ce nom sera la clé utilisée pour la sauvegarde des données.</p><h5 id=label-1>label</h5><p>Le libellé du champs.</p><h5 id=mandatory>mandatory</h5><p>Si le champ est obligatoire ou non (booléen).</p><h5 id=default-optionnel>default (optionnel)</h5><p>Valeur par défaut du champ.</p><h5 id=maxlength-optionnel>maxlength (optionnel)</h5><p>Longueur max de la valeur.</p><h5 id=notes-optionnel>notes (optionnel)</h5><p>Permet d&rsquo;ajouter des annotations à coté d&rsquo;un champs, pour guider l&rsquo;usage.</p><p>Plusieurs formes possibles :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>label</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Ceci est une note...&#39;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>On peut aussi se baser sur des choix précédemment fait (et donc dans la stack) pour peronnaliser les notes à partir d&rsquo;une liste remontée du backend.</p><p>Par exemple, le backend a une liste de tags, pour chaque tag une note optionnelle à afficher. On va donc charger une liste de tags depuis le backend, chercher le tag qui est actuellement appliqué au produit, et afficher la note correspondante.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>interface</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>load</span>: <span style=color:#66d9ef>string</span>, <span style=color:#75715e>// Le nom de la source backend à utiliser (exemple : les pcat)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>basedOnValueOf</span>: <span style=color:#66d9ef>string</span>, <span style=color:#75715e>// nom de champs qu&#39;on va chercher dans la stack. On utilisera la valeur de ce champs pour filtrer 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>key</span>: <span style=color:#66d9ef>string</span>, <span style=color:#75715e>// le champs clé dans la source de donnée, dans lequel il vaut chercher la valeur de la stack (ex: rowid)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>field</span>: <span style=color:#66d9ef>string</span>, <span style=color:#75715e>// le nom du champs de la source de donnée qui contient les notes à afficher (ex: notes)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><h3 id=statepick>StatePick</h3><p>La classe <a href=/src/lib/state/pick.ts>StatePick</a> proposera de sélectionner une valeur dans une ou plusieurs liste(s) (en utilisant des widgets de type «autocomplete»).</p><h4 id=key>key</h4><p>La clé qui sera utilisée pour charger la liste depuis le backend.</p><h4 id=fields-1>fields</h4><p>On peut donc sélectionner une ligne avec un ou plusieurs champs successifs. Exemple : d&rsquo;abord la marque, puis la référence.
La liste des références sera filtrée en fonction de la marque préalablement choisie.</p><p>La définition d&rsquo;un field :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>PickField</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>string</span>, <span style=color:#75715e>// le nom du champs tel qu&#39;il sera stocké dans la stack
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>label</span>: <span style=color:#66d9ef>string</span>, <span style=color:#75715e>// le libellé du champs
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>applyFilter</span><span style=color:#f92672>?:</span> <span style=color:#e6db74>&#39;lowerCase&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;upperCase&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;localeLowerCase&#39;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#39;localeUpperCase&#39;</span> <span style=color:#75715e>// un filtre à appliquer aux valeurs pour les homogénéiser. 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><h4 id=primarykey>primaryKey</h4><p>Nom du champs dans la source de donnée qui contient la valeur à stocker dans la stack (la clé primaire).</p><h4 id=goto-et-itemgotofieldoptionnel>goto et itemGotoField(optionnel)</h4><p>L&rsquo;état où aller après avoir sélectionné une valeur.</p><p>Chaque item peut surcharger cette valeur.
Si itemGotoField est fourni, on cherchera un champs de ce nom dans l&rsquo;item sélectionnée. Si la source a fourni une valeur, ce sera le nom du state vers lequel aller pour cette valeur spécifique.</p><p>Ainsi, le backend peut piloter le comportement de l&rsquo;automate. Par exemple, afficher un formulaire différent en fonction de la catégorie de produit.</p><h4 id=creationgoto--creationlabel-optionnel>creationGoto / creationLabel (optionnel)</h4><p>Si fourni, un bouton «créer nouveau» sera affiché. La valeur est le state dans lequel aller.</p><p>creationLabel permet de personnaliser le libellé du bouton.</p><h3 id=stateselect>StateSelect</h3><p>La classe <a href=/src/lib/state/select.ts>StateSelect</a> est un état qui affichera un <code>select</code>.</p><h4 id=options>options</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>Option</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>value</span>: <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>label</span>: <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=stateshow>StateShow</h3><p>La classe <a href=/src/lib/state/show.ts>StateShow</a> représente une page va afficher un objet remonté du backend.
Par exemple une fiche produit.</p><h4 id=key-1>key</h4><p>Le type d&rsquo;objet (clé pour la source backend). Par exemple <code>product</code>.</p><h4 id=primarykey-1>primaryKey</h4><p>Nom de la clé à chercher dans la stock, pour avoir l&rsquo;id à chercher niveau backend.
Par exemple <code>product</code> si dans ma stack j&rsquo;ai un champ <code>product</code> dont la valeur est l&rsquo;id produit.</p><h4 id=fields-2>fields</h4><p>Les champs à afficher.
Voir le code pour la doc (le code bouge encore, ce sera à documenter plus tard).</p><h4 id=okgoto-optionnel>okGoto (optionnel)</h4><p>Affiche un bouton «ok» qui ira sur le state correspondant.</p><h4 id=addgoto--addlabel-optionnel>addGoto / addLabel (optionnel)</h4><p>Affiche un bouton «ajouter» qui ira sur le state correspondant.</p><p>addLabel permet de personnaliser le libellé du bouton.</p><h3 id=statevirtual>StateVirtual</h3><p>La classe <a href=/src/lib/state/virtual.ts>StateVirtual</a> est un état virtuel qui avance automatiquement.</p><h3 id=statecompute>StateCompute</h3><p>La classe <a href=/src/lib/state/compute.ts>StateCompute</a> est un état virtuel qui permet d&rsquo;effectuer des modifications sur les valeurs en stack.</p><p>Par exemple d&rsquo;injecter les valeurs de la stack dans un template, et de de s&rsquo;en serveur pour générer une description.</p><p>Cette classe n&rsquo;est pas documentée pour l&rsquo;instant, car non utilisée et sujette à changements.</p><h3 id=statesave>StateSave</h3><p>La classe <a href=/src/lib/state/save.ts>StateSave</a> permet de faire un récapitulatif des données dans la stack, et de proposer de les enregistrer.</p><p>Documentation à faire.</p><h2 id=notes>Notes</h2><p>Pour débuguer, on peut accéder à la machine dans la console JS du navigateur via <code>window.pickupMobileMachine</code>.
La stack est dans <code>window.pickupMobileMachine.stack</code>. On peut en avoir une version «lisible à l&rsquo;oeil humain» via <code>window.pickupMobileMachine.stack.dumpForHuman()</code>.</p><p>On peut également débuguer le cache des données remontées du backend via <code>window.pickupMobileDebugDataCache()</code>.</p><p>Il y a une fonction qui essaie de trouver les problèmes de définition de l&rsquo;automate (status manquants, template manquant, etc&mldr;) : <code>window.pickupMobileMachine.findProblems().then(console.log)</code>.</p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/DolibarrPickup/dev/ title=Contribuer><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/DolibarrPickup/problems/ title="Problèmes connus" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/DolibarrPickup/js/clipboard.min.js?1647595654></script>
<script src=/DolibarrPickup/js/perfect-scrollbar.min.js?1647595654></script>
<script src=/DolibarrPickup/js/perfect-scrollbar.jquery.min.js?1647595654></script>
<script src=/DolibarrPickup/js/jquery.sticky.js?1647595654></script>
<script src=/DolibarrPickup/js/featherlight.min.js?1647595654></script>
<script src=/DolibarrPickup/js/highlight.pack.js?1647595654></script>
<script>hljs.initHighlightingOnLoad()</script><script src=/DolibarrPickup/js/modernizr.custom-3.6.0.js?1647595654></script>
<script src=/DolibarrPickup/js/learn.js?1647595654></script>
<script src=/DolibarrPickup/js/hugo-learn.js?1647595654></script>
<link href=/DolibarrPickup/mermaid/mermaid.css?1647595654 rel=stylesheet><script src=/DolibarrPickup/mermaid/mermaid.js?1647595654></script>
<script>mermaid.initialize({startOnLoad:!0})</script></body></html>