{% if dataStatus === 'pending' %}
  <div class="alert alert-secondary" pickupmobile-form-pending>
    <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
    {{ translate('Waiting...') }}
  </div>
{% elif dataStatus === 'rejected' %}
  <div class="alert alert-danger">
    {{ translate('Error retrieving data.') }}
  </div>
  <div class="row justify-content-center">
    <a class="col-4 btn btn-primary" pickupmobile-form-reload>
      {{ translate('Try again') }}
    </a>
  </div>
{% elif dataStatus === 'resolved' %}
  <table class="table">
    {% for field in currentState.fields %}
      {% if useDefaultValues %}
        {% set currentValue = field.default %}
      {% else %}
        {% set currentValue = stack.getValue(field.name) %}
      {% endif %}
      {% set invalid = stack.isValueInvalid(field.name) %}
      <tr>
        <td>
          <label
            class="{% if invalid %}pickupmobile-error{% endif %} {% if field.mandatory %}fieldrequired{% endif %}"
            for="{{ field.name }}"
          >
            {{ field.label }}
          </label>
        </td>
        <td>
          {% if field.notes and field.notes.label %}
            <div>
              {% for noteLine in field.notes.label.split('\n') %}
                <p>{{ noteLine }}</p>
              {% endfor %}
            </div>
          {% endif %}
          {% if field.type === 'varchar' %}
            <input type="text"
              name="{{ field.name }}"
              value="{{ currentValue }}"
              {% if field.maxLength %} maxlength="{{ field.maxLength }}" {% endif %}
            />
          {% elif field.type === 'integer' or field.type === 'float' %}
            <input type="number"
              name="{{ field.name }}"
              value="{{ currentValue }}"
              min="{{ field.min }}"
              max="{{ field.max }}"
              {% if field.type === 'float' %}step="{{ field.step }}"{% endif %}
            />
          {% elif field.type === 'text' %}
            <textarea name="{{ field.name }}">{{ currentValue }}</textarea>
          {% elif field.type === 'select' %}
            <select name="{{ field.name }}">
            {% for option in field.options %}
              <option value="{{ option.value }}" {% if option.value === currentValue %}selected="selected"{% endif %}>
                {{ option.label }}
              </option>
            {% endfor %}
            </select>
          {% elif field.type === 'radio' %}
            {% for option in field.options %}
              <label>
                <input name="{{ field.name }}"
                  type="radio"
                  value="{{ option.value }}"
                  {% if currentValue === option.value %}checked="checked"{% endif %}
                />
                {{ option.label }}
              </label>
            {% endfor %}
          {% elif field.type === 'boolean' %}
            <input type="checkbox"
              name="{{ field.name }}"
              value="1"
              {% if currentValue === '1' %}checked="checked"{% endif %}
            />
          {% elif field.type === 'date' %}
            <input type="date"
              name="{{ field.name }}"
              value="{{ currentValue }}"
            />
          {% endif %}
        
          {% if invalid %}
            <div class="pickupmobile-error">{{ invalid }}</div>
          {% endif %}
        </td>
      </tr>
    {% endfor %}
  </table>

  <hr>
  <nav>
    <input type="submit" value="{{ translate('Ok') }}" class="btn btn-primary" />
  </nav>
{% endif %}
